---
page_title: 'Plugin Development - Acceptance Testing: Import mode'
description: |-
  _Import_ mode is used for testing resource functionality to import existing
  infrastructure into a Terraform statefile, using real Terraform import logic.
---

# Acceptance Tests: Import mode

_Import_ is the workflow that enables users to bring existing infrastructure
into Terraform, without altering the infrastructure itself. For reference
information about the _Import_ workflow: [ LINK ] [ LINK ].

For example: a user has an existing Amazon S3 bucket, and they would like to
manage it in Terraform. They write two configuration blocks: one to manage the
resource and one to import the resource.

```terraform
provider "aws" {
  region = "us-east-2"
}

resource "aws_s3_bucket" "uploads" {
  bucket = "uploads"
}

import {
  to = aws_s3_bucket.uploads
  id = "uploads"
}
```

```shell
$ terraform plan

[ OUTPUT ]

$ terraform apply
```

After the resource is imported into Terraform state, they can manage the bucket
in Terraform and use it as a building block for new infrastructure. They can
also remove the `import` block -- it has no effect on an already-imported
resource.

```terraform
provider "aws" {
  region = "us-east-2"
}

resource "aws_s3_bucket" "uploads" {
  bucket = "uploads"

  tags = {
    Application = "the-uploader"
  }
}
```

```
$ terraform plan

[ OUTPUT ]

$ terraform apply
```

In provider acceptance tests, _Import_ mode is used for testing resource
functionality to import existing infrastructure into a Terraform statefile,
using real Terraform import functionality.

At its essence, _Import_ mode runs the _Import_ workflow and checks: does a
resource added by _Import_ match a resource added by _Lifecycle_ methods (i.e.
_Create_)?

In common testing terminology, _Import_ mode uses a resource added to Terraform
by _Create_ as the _expected result_.

_Import_ mode uses a resource added to Terraform by _Import_ as the _actual
result_.

_Import_ mode runs a deep comparison of the two data structures. The test step
passes :green_check_mark: only if the two data structures match.

## Reference

### Testing the `terraform import` workflow

#### _Import_ mode setup

| Field                                                    |                                                    |
|----------------------------------------------------------|----------------------------------------------------|
| `ImportState`                                            | `true`                                             |
| `ResourceName`<br/>`ImportStateId`<br/>`ImportStateFunc` |  Required. Identifies the resource to be imported. |
| `ImportStatePrefix`                                      |                                                    |


#### Configuration source

| Field             |     |
|-------------------|-----|
| `<none>`          |     |
| `Config`          |     |
| `ConfigFile`      |     |
| `ConfigDirectory` |     |

#### Tests

| Field                     |     |
|---------------------------|-----|
| `ImportStateChecks`       |     |
| `ImportStateVerify`       |     |
| `ImportStateVerifyIgnore` |     |

```go
func TestImportCommand(t *testing.T) {
	t.Parallel()

	providerFactories := map[string]func() (tfprotov6.ProviderServer, error) {
		// TODO
	}

	step1 := r.TestStep{
		// TODO: a runnable provider
		Config: `resource "examplecloud_thing" "test" {}`,
	}

	step2 := r.TestStep{
		ImportState:       true,
		ResourceName:      "examplecloud_thing.test",
		ImportStateVerify: true,
	})

	r.UnitTest(t, r.TestCase{
		ProtoV5ProviderFactories: providerFactories,
		Steps: []r.TestStep{step1, step2},
	})
}
```

```
$ go test ./[package] -run=TestImportCommand

[ output ]
```

### Testing the plannable import workflow

#### _Import_ mode setup

| Field                                                    |                                                    |
|----------------------------------------------------------|----------------------------------------------------|
| `ImportState`                                            | `true`                                             |
| `ImportStateKind`                                        | `resource.ImportBlockWithID`                       |
| `ResourceName`<br/>`ImportStateId`<br/>`ImportStateFunc` |  Required. Identifies the resource to be imported. |
| `ImportStatePrefix`                                      |                                                    |


#### Configuration source

| Field             |     |
|-------------------|-----|
| `<none>`          |     |
| `Config`          |     |
| `ConfigFile`      |     |
| `ConfigDirectory` |     |

#### Tests

| Field              |     |
|--------------------|-----|
| `ImportPlanChecks` |     |

```go
func TestImportBlockWithID(t *testing.T) {
	t.Parallel()

	providerFactories := map[string]func() (tfprotov6.ProviderServer, error) {
		// TODO
	}

	step1 := r.TestStep{
		Config: `resource "examplecloud_thing" "test" {}`,
	}

	step2 := r.TestStep{
		ImportState:       true,
		ImportStateKind:   resource.ImportBlockWithID,
		ResourceName:      "examplecloud_thing.test",
	})

	r.UnitTest(t, r.TestCase{
		ProtoV5ProviderFactories: providerFactories,
		Steps: []r.TestStep{step1, step2},
	})
}

```
$ go test ./[package] -run=TestImportBlockWithID

[ output ]
```

#### Testing the plannable import workflow using a managed resource identity

#### _Import_ mode setup

| Field                                                    |                                                    |
|----------------------------------------------------------|----------------------------------------------------|
| `ImportState`                                            | `true`                                             |
| `ImportStateKind`                                        | `resource.ImportBlockWithResourceIdentity`         |
| `ResourceName`<br/>`ImportStateId`<br/>`ImportStateFunc` |  Required. Identifies the resource to be imported. |
| `ImportStatePrefix`                                      |                                                    |


#### Configuration source

| Field             |     |
|-------------------|-----|
| `<none>`          |     |
| `Config`          |     |
| `ConfigFile`      |     |
| `ConfigDirectory` |     |

#### Tests

| Field              |     |
|--------------------|-----|
| `ImportPlanChecks` |     |

```go
func TestImportBlockWithResourceIdentity(t *testing.T) {
	t.Parallel()

	providerFactories := map[string]func() (tfprotov6.ProviderServer, error) {
		// TODO
	}

	step1 := r.TestStep{
		Config: `resource "examplecloud_thing" "test" {}`,
	}

	step2 := r.TestStep{
		ImportState:       true,
		ImportStateKind:   resource.ImportBlockWithResourceIdentity,
		ResourceName:      "examplecloud_thing.test",
	})

	r.UnitTest(t, r.TestCase{
		ProtoV5ProviderFactories: providerFactories,
		Steps: []r.TestStep{step1, step2},
	})
}

```
$ go test ./[package] -run=TestImportBlockWithResourceIdentity

[ output ]
```
