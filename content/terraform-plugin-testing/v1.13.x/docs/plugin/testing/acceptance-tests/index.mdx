---
page_title: Plugin Development - Acceptance Testing
description: |-
  Terraform includes a framework for constructing acceptance tests that
  imitate applying one or more configuration files.
---

# Acceptance Tests

Acceptance tests for Terraform providers are implemented using the
[`terraform-plugin-testing`](https://pkg.go.dev/github.com/hashicorp/terraform-plugin-testing)
framework. The testing framework uses a local Terraform binary to perform real
plan, apply, refresh, and destroy operations, and enables developers to make
assertions about what happens during those actions.

When testing the happy path, developers can make assertions about what data is
stored in state after successfully provisioning a resource. When testing
unhappy paths, developers are able to make assertions about errors returned by
Terraform, non-empty plans, and the actual cloud resources created by
Terraform.

~> **Note**: Acceptance tests can create and destroy real infrastructure
resources, possibly incurring expenses and consuming quotas. The testing
framework provides a way to check that all resources created by tests are
destroyed. For more information: [Requirements and
recommendations](#requirements-and-recommendations).

## Test files

Terraform follows many of the Go programming language conventions with regards
to testing, with both acceptance tests and unit tests being placed in a file
that matches the file under test, with an added `_test.go` suffix. Here's an
example file structure:

```
terraform-plugin-example/
├── provider.go
├── provider_test.go
├── example/
│   ├── resource_example_compute.go
│   ├── resource_example_compute_test.go
```

To create an acceptance test in the example `resource_example_compute_test.go`
file, the function name must begin with `TestAcc` and take a
[`*testing.T`](https://pkg.go.dev/testing#T) argument.

```
func TestAccExampleComputeResource(*testing.T) {
	// ....
}
```

## Requirements and recommendations

Acceptance tests have the following requirements:

- **[Go](https://go.dev/)**: The most recent stable version.
- **Terraform CLI**: Version 0.12.26 or later.
- **Provider Access**: Network or system access to the provider and any
  resources being tested.
- **Provider Credentials**: Authorized credentials to the provider and any
  resources being tested.
- **`TF_ACC` Environment Variable**: Set to any value. Prevents developers from
  incurring unintended charges when running other Go tests.

We also recommend the following when running acceptance tests:

- **A separate Account**: Use a separate provider account or namespace for
  acceptance testing. This prevents Terraform from unexpectedly modifying or
destroying infrastructure due to code or testing issues.
- **Previous Terraform CLI Installation**: Install Terraform CLI either into
  the operating system `PATH` or use the `TF_ACC_TERRAFORM_PATH` environment
variable prior to running acceptance tests. Otherwise, the testing framework
will download and install the latest Terraform CLI version into a temporary
directory for every test invocation. Refer to the [Terraform CLI Installation
Behaviors](#terraform-cli-installation-behaviors) section for details.

Each provider may have additional requirements and setup recommendations. Refer
to the provider's codebase for more details.

## Running Acceptance Tests

Ensure that the [acceptance testing
requirements](#requirements-and-recommendations) are met and then use the [`go
test`](https://pkg.go.dev/cmd/go/internal/test) command to run acceptance
tests. You can run the acceptance tests on any environment capable of running
`go test`, such as a local workstation [command line](#command-line-workflow),
or continuous integration runner, such as [GitHub
Actions](/plugin/testing/acceptance-tests/continuous-integration).

### Command Line Workflow

Run acceptance testing with the command line of any workstation. Use these
instructions as the basis for other environments such as continuous integration
runners.

The following example will execute all available acceptance tests in a provider
codebase:

```shell TF_ACC=1 go test -v ./...  ```

Some provider codebases also implement a
[Makefile](https://www.gnu.org/software/make/manual/make.html#Makefiles) with a
`testacc` target, which will set `TF_ACC` and other testing flags
automatically.

The following is an example Makefile configuration:

```make testacc: TF_ACC=1 go test -v ./...  ```

The Makefile configuration lets developers to use the following command to run
acceptance tests:

```shell make testacc ```

### Terraform CLI Installation Behaviors

The testing framework implements the following Terraform CLI discovery and
installation behaviors:

- If the `TF_ACC_TERRAFORM_PATH` environment variable is set, the framework
  will use that Terraform CLI binary if it exists and is executable. If the
framework cannot find the binary or it is not executable, the framework returns
an error unless the `TF_ACC_TERRAFORM_VERSION` environment variable is also
set.
- If the `TF_ACC_TERRAFORM_VERSION` environment variable is set, the framework
  will install and use that Terraform CLI version.
- If both the `TF_ACC_TERRAFORM_PATH` and `TF_ACC_TERRAFORM_VERSION`
  environment variables are unset, the framework will search for the Terraform
CLI binary based on the operating system `PATH`. If the framework cannot find
the specified binary, it installs the latest available Terraform CLI binary.

Refer to the [Environment Variables](#environment-variables) section for more
details about behaviors and valid configurations.

## Troubleshooting

This section lists common errors encountered during testing.

### Unrecognized remote plugin message

``` terraform failed: exit status 1

	stderr:

	Error: Failed to instantiate provider "random" to obtain schema:
Unrecognized remote plugin message: --- FAIL: TestAccResourceID (4.28s)

	This usually means that the plugin is either invalid or simply needs to
be recompiled to support the latest protocol.  ```

This error indicates that the provider server could not connect to Terraform
Core. Verify that the output of `terraform version` is v0.12.26 or above.

## Next Steps

Terraform relies heavily on acceptance tests to ensure we keep our promise of
helping users safely and predictably create, change, and improve
infrastructure. In our next section we detail how to create “Test Cases”,
individual acceptance tests using Terraform's testing framework, in order to
build and verify real infrastructure. [Proceed to Test
Cases](/terraform/plugin/testing/acceptance-tests/testcase)
