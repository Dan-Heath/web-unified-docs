---
page_title: Retrieve sensitive values at runtime with ephemeral values
description: Use ephemeral values to keep sensitive data out of Terraform state and plan files entirely by retrieving them at runtime.
---

# Retrieve sensitive values at runtime with ephemeral values

Ephemeral values are available at the run time of an operation, but Terraform omits them from state and plan files. Because Terraform does not store ephemeral values, you must capture any generated values you want to preserve in another resource or output in your configuration.

You can use the following methods ways to define ephemeral values in your configuration:

- The [`ephemeral` argument on variables and child module outputs](#add-the-ephemeral-argument-to-a-variable-or-output)
- The [`ephemeral` block](#use-the-ephemeral-block)
- A [write-only argument](#use-write-only-arguments) on a managed resource

Terraform restricts where you can reference ephemeral values in your configuration. You can only refer to ephemeral values in the following contexts:

- In the [`locals` block](/terraform/language/block/locals)
- In [`variable` blocks with the `ephemeral` argument](/terraform/language/block/variable#ephemeral)
- In [child module `output` blocks with the `ephemeral` argument](/terraform/language/block/output#ephemeral)
- In a managed resource [write-only argument](/terraform/language/manage-sensitive-data/write-only)
- The [`ephemeral` block](/terraform/language/block/ephemeral)
- Configuring [providers in the `provider` block](/terraform/language/functions/terraform-applying)
- In [provisioner](/terraform/language/resources/provisioners/syntax) and [connection](/terraform/language/resources/provisioners/connection) blocks

## Add the `ephemeral` argument to a variable or output

Set the `ephemeral` argument to `true` in a `variable` block containing temporary sensitive data to omit that value from state and plan files:

<CodeBlockConfig highlight="5">

```hcl
variable "api_token" {
  description = "Short-lived API token for provider authentication"
  type        = string
  sensitive   = true
  ephemeral   = true
}
```

</CodeBlockConfig>

You can reference a `variable` block with the `ephemeral` argument in other [ephemeral contexts](#omit-values-from-state-and-plan-files). For example, you can use the `api_token` variable in a `provider` block to configure a provider:

```hcl
provider "example" {
  api_token = var.api_token
}
```

You can also add the `ephemeral` argument in the `output` block in child modules to pass data between modules without persisting that data to state or plan files. You cannot add the `ephemeral` argument to outputs in the root module.

<CodeBlockConfig highlight="3">

```hcl
output "session_token" {
  value     = ephemeral.auth_provider.main.token
  ephemeral = true
  sensitive = true
}
```

</CodeBlockConfig>

Passing output values between child modules and the root module is useful for managing credentials, tokens, and other temporary values that you do not want to store in state.

You can also add the `sensitive` argument to `variable` and `output` blocks to hide their values in the CLI and HCP Terraform UI. Learn more about [using the `ephemeral` argument alongside the `sensitive` argument](#hide-values-without-storing-them).

## Use the `ephemeral` block

The `ephemeral` block declares a temporary ephemeral resource that only exists during the current Terraform operation. Terraform does not store ephemeral resources in state or plan files, making them ideal for managing sensitive or temporary data that you do not want to persist, such as temporary passwords or connections to other systems. Each provider defines any available ephemeral resources. Reference the [Terraform registry](https://registry.terraform.io) to learn more about what your provider supports.

For example, you can use the `random_password` ephemeral resource to generate a temporary password:

```hcl
ephemeral "random_password" "db_password" {
  length           = 16
  override_special = "!#$%&*()-_=+[]{}<>:?"
}
```

You can only reference an `ephemeral` block in other ephemeral contexts, such as a write-only argument in a managed resource. Write-only arguments let you securely pass temporary values to managed resources during an operation without persisting those resource values. For example, you can reference the `db_password` in the `password_wo` write-only argument:

<CodeBlockConfig highlight="3,16">

```hcl
#...
ephemeral "random_password" "db_password" {
  length           = 16
  override_special = "!#$%&*()-_=+[]{}<>:?"
}
resource "aws_db_instance" "example" {
  instance_class       = "db.t3.micro"
  allocated_storage    = "5"
  engine               = "postgres"
  username             = "example"
  skip_final_snapshot  = true
  publicly_accessible  = true
  db_subnet_group_name = aws_db_subnet_group.example.name
  password_wo          = ephemeral.random_password.db_password.result
  password_wo_version  = 1
}
```

</CodeBlockConfig>

Neither write-only arguments nor `ephemeral` blocks persist outside of the current Terraform run. This ensures that the `ephemeral.random_password.db_password.result` value is completely omitted from state and plan files.

Terraform does not store the generated value of `ephemeral.random_password.db_password.result`, but you can capture it in another resource to ensure the value is not lost. For an example of generating, storing, retrieving, and using an ephemeral password, refer to [write-only arguments](/terraform/language/manage-sensitive-data/write-only#set-and-store-an-ephemeral-password-in-aws-secrets-manager).

To learn about ephemeral resources, refer to the [`ephemeral` block reference](/terraform/language/block/ephemeral).