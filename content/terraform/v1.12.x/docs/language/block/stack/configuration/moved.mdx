---
page_title: Moved block reference for Terraform Stacks
description: Use the `moved` block to move or rename resources within your Stack components without destroying and recreating the underlying infrastructure.
---

# `moved` block reference for Stacks

Use the `moved` block to move or rename resources within your Stack components without destroying and recreating the underlying infrastructure.

## Background

The `moved` block in Stack configurations allows you to refactor your Stack components by moving or renaming resources without destroying the underlying infrastructure. This is useful when you need to reorganize your Stack structure, rename components, or move resources between components.

When you use a `moved` block, Terraform updates its state to reflect the new resource addresses while leaving the actual infrastructure unchanged. This allows you to safely refactor your Stack configuration without service disruption.

The `moved` block is particularly useful in Stacks when you need to:
- Rename components within your Stack
- Move resources between different components
- Reorganize your component structure
- Refactor module structures within components

## Configuration model

The `moved` block supports the following arguments:

- [`moved`](#moved) &nbsp; block
  - [`from`](#from) &nbsp; reference
  - [`to`](#to) &nbsp; reference

## Complete configuration

All available arguments are defined in the following `moved` block:

```hcl
moved {
  from = <OLD_RESOURCE_ADDRESS>
  to   = <NEW_RESOURCE_ADDRESS>
}
```

## Specification

A `moved` block supports the following configuration.

### `moved`

The `moved` block does not take a label. Each `moved` block represents a single resource move operation within your Stack.

The following arguments are supported in a `moved` block:

| Argument | Description | Type | Required? |
| --- | --- | --- | --- |
| `from` | The old resource address that you want to move from. | Reference | Required |
| `to` | The new resource address that you want to move to. | Reference | Required |

### `from`

The `from` argument specifies the old resource address that you want to move. This can be a component resource, a module resource within a component, or any other addressable resource in your Stack.

```hcl
moved {
  from = component.old_name.aws_s3_bucket.main
  to   = component.new_name.aws_s3_bucket.main
}
```

The resource address follows the pattern `component.<COMPONENT_NAME>.<RESOURCE_TYPE>.<RESOURCE_NAME>` for resources managed by components.

#### Summary

- Data type: Reference
- Default: None
- Required: Yes

### `to`

The `to` argument specifies the new resource address that you want to move the resource to. The resource must exist at this new address in your current configuration.

```hcl
moved {
  from = component.database.aws_db_instance.main
  to   = component.data_storage.aws_db_instance.primary
}
```

#### Summary

- Data type: Reference
- Default: None
- Required: Yes

## Move workflow

To move resources within your Stack, follow this workflow:

1. **Update your configuration** with the new resource structure
2. **Add `moved` blocks** for each resource that changed address
3. **Run `terraform plan`** to verify the move operations
4. **Apply the configuration** to execute the moves
5. **Remove the `moved` blocks** after successful application
6. **Verify resources** are now at their new addresses

## Examples

The following examples demonstrate common use cases for `moved` blocks in Stacks.

### Renaming a component

In the following example, a component is renamed from `storage` to `s3_storage`:

```hcl
# New component configuration
component "s3_storage" {
  source = "./modules/s3"
  
  inputs = {
    bucket_name = "my-app-storage"
  }
  
  providers = {
    aws = provider.aws.main
  }
}

# Move resources to the new component
moved {
  from = component.storage.aws_s3_bucket.main
  to   = component.s3_storage.aws_s3_bucket.main
}

moved {
  from = component.storage.aws_s3_bucket_policy.main
  to   = component.s3_storage.aws_s3_bucket_policy.main
}
```

### Moving resources between components

In the following example, a database resource is moved from one component to another:

```hcl
# Original application component (without database)
component "application" {
  source = "./modules/app-only"
  
  inputs = {
    instance_type = "t3.medium"
  }
  
  providers = {
    aws = provider.aws.main
  }
}

# New dedicated database component
component "database" {
  source = "./modules/database"
  
  inputs = {
    instance_class = "db.t