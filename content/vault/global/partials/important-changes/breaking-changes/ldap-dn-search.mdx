### LDAP user DN search with upndomain ((#ldap-dn-search))


<!-- BEGIN: Vault:=v1.19.x -->

| Change       | Affected version | Vault edition
| ------------ | ---------------- | -------------
| Breaking     | 1.20.0           | All

<!-- END: Vault:=v1.19.x -->

Security improvements to
[`hashicorp/cap/ldap`](https://github.com/hashicorp/cap/tree/main/ldap) ensure
that user DN searches with `upndomain` configured return an error if the search
returns more than one result.

#### Recommendation

In previous Vault versions, DN searches with `upndomain` configured returned the
last user found for searches with multiple results. Review and update any code
that performs DN searches to handle multi-result errors and/or revise the search
to ensure a single result.

Refer to [the Github PR](https://github.com/hashicorp/cap/pull/151) for more
details.
