---
layout: api
page_title: SPIFFE - Auth Methods - HTTP API
description: This is the API documentation for the Vault SPIFFE authentication method.
---

# SPIFFE auth method (API)

This is the API documentation for the Vault SPIFFE auth method. For
general information about the usage and operation of the SPIFFE method, please
see the [Vault SPIFFE method documentation](/vault/docs/auth/spiffe).

This documentation assumes the SPIFFE method is mounted at the `/auth/spiffe`
path in Vault. Since it is possible to enable auth methods at any location,
please update your API calls accordingly.

## Create configuration

Configures the SPIFFE trust domain and associated trust bundle to be used.

If using a profile that fetches the trust bundle from a remote endpoint, an immediate
fetch will be attempted unless `defer_bundle_fetch` is set to true. If the fetch fails,
the configuration will not be updated and an error will be returned.

An existing cached bundle can be forced refreshed by calling this endpoint, even an empty
payload will trigger a refresh.

| Method | Path                  |
|:-------|:----------------------|
| `POST` | `/auth/spiffe/config` |

### Parameters

- `trust_domain` `(string: <required>)` - The SPIFFE trust domain for the backend. This
can be prefixed with `spiffe://` but it is not required.
- `profile` `(string: <required>)` - The profile to use to fetch the trust bundle, see profile section below
for associated parameters based on the selected profile. Valid values are `static`,
`https_web_pem`, `https_web_bundle` or `https_spiffe_bundle`.
- `audience` `(array: [])` - A list of allowed audience values for JWT based SVIDs. Any matching element within
the array will be allowed to authenticate. If empty, all JWT based SVIDS will be denied.
- `defer_bundle_fetch` `(bool: false)` - If true, Vault will not attempt to fetch the remote trust bundle
to validate the configuration. This is useful if the remote endpoint is not yet available.

#### Profile parameters

Based on the provided value for `profile`, the following additional parameters are enabled

##### Static profile (static)

Provide the trust bundle directly as part of the configuration

- `bundle` `(string: <required>)` - A PEM encoded X.509 certificate or a JWKS document following
the SPIFFE Trust Domain and Bundle specification.

##### Remote HTTPS Web PEM profile (https_web_pem)

Fetch an X.509 certificate that will act as a trust bundle from a remote HTTPS endpoint

- `endpoint_url` `(string: <required>)` - The HTTPS URL to fetch the PEM encoded X.509 certificate from.
- `endpoint_root_ca_truststore_pem` `(string: "")` - A PEM encoded X.509 certificate to use as a root CA to validate
the remote endpoint's TLS certificate. If not provided, the system root CAs will be used.

##### Remote HTTPS Web Bundle profile (https_web_bundle)

Fetch a SPIFFE bundle in JWKS format from a remote HTTPS endpoint. If using a SPIRE server, this will work with
a SPIRE Federation API endpoint of type `https_web`.

- `endpoint_url` `(string: <required>)` - The HTTPS URL to fetch the PEM encoded X.509 certificate from.
- `endpoint_root_ca_truststore_pem` `(string: "")` - A PEM encoded X.509 certificate to use as a root CA to validate
the remote endpoint's TLS certificate. If not provided, the system root CAs will be used.

##### Remote HTTPS SPIFFE Bundle profile (https_spiffe_bundle)

Fetch a SPIFFE bundle in JWKS format from a remote SPIFFE endpoint. If using a SPIRE server, this will work with
a SPIRE Federation API endpoint of type `https_spiffe`.

- `endpoint_spiffe_id` `(string: <required>)` - The SPIFFE ID of the remote endpoint to connect to.
- `endpoint_url` `(string: <required>)` - The HTTPS URL to fetch the PEM encoded X.509 certificate from.
- `bundle` `(string: <required>)` - A SPIFFE bundle in JKWS format to use as a trust anchor to validate the remote endpoint's TLS certificate.

### Sample payload

```json
{
  "trust_domain": "example.org",
  "profile": "https_web_bundle",
  "endpoint_url": "https://spire.example.org",
  "endpoint_root_ca_truststore_pem": "-----BEGIN CERTIFICATE-----\n...\n-----END CERTIFICATE-----\n",
  "audience": ["vault"]
}
```

## Read configuration

Reads the SPIFFE configuration along with the various pieces of information around the remote fetched trust bundle.

| Method | Path                  |
|:-------|:----------------------|
| `GET`  | `/auth/spiffe/config` |

### Parameters

None

### Sample response

```json
{
  "cached_bundle_config_version": 1,
  "cached_bundle_fetched_at": "2025-09-18T14:02:21.730308-04:00",
  "cached_bundle_refresh_hint": "15m0s",
  "cached_bundle_sequence_number": 11,
  "endpoint_root_ca_truststore_pem": "-----BEGIN CERTIFICATE-----\n...\n-----END CERTIFICATE-----\n",
  "endpoint_url": "https://192.168.1.65:8443",
  "profile": "https_web_bundle",
  "trust_domain": "spiffe://test.dadgarcorp.org",
  "version": 1
}
```

## Create role

Creates or updates a named role, which defines the mapping between SPIFFE IDs and Vault policies.

Different roles may not have the same workload id patterns. If there are overlapping patterns across
different roles (e.g. role1 has `team1/*` and role2 has `team1/service1`), the same
[priority matching](vault/docs/concepts/policies#priority-matching) logic that is used for policies
is used to determine which role is selected.

| Method | Path                       |
|:-------|:---------------------------|
| `POST` | `/auth/spiffe/role/:name` |

### Parameters

- `name` `(string: <required>)` - The name of the role specified in the URL.
- `display_name` `(string: "<name>")` - The `display_name` value for tokens issued when authenticating
against the role. Defaults to `name`.
- `workload_id_patterns` `(array: <required>)` - A comma separated list of patterns that match an incoming workload
id to this role.  A workload id is the part that remains after stripping the trust domain prefix
and the slash separator from a spiffe id. Each pattern may end in * to do a prefix match, and they may contain +
to denote any number of characters bounded within a single path segment.

@include 'tokenfields.mdx'

### Sample payload

```json
{
  "workload_id_patterns": ["service1", "team1/*", "team2/+/service1"],
  "display_name": "example-role",
  "token_policies": ["spiffe-service1"]
}
```

## Read role

Reads the named SPIFFE role.

| Method | Path                      |
|:-------|:--------------------------|
| `GET`  | `/auth/spiffe/role/:name` |

### Parameters

- `name` `(string: <required>)` - The name of the role specified in the URL.

### Sample Response

```json
{
  "alias_metadata": {},
  "display_name": "example-role",
  "name": "example-role",
  "token_bound_cidrs": [],
  "token_explicit_max_ttl": 0,
  "token_max_ttl": 0,
  "token_no_default_policy": false,
  "token_num_uses": 0,
  "token_period": 0,
  "token_policies": [
    "spiffe-service1"
  ],
  "token_ttl": 0,
  "token_type": "default",
  "workload_id_patterns": [
    "service1",
    "team1/*",
    "team2/+/service1"
  ]
}
```

## Delete role

Deletes the named SPIFFE role.

| Method   | Path                      |
|:---------|:--------------------------|
| `DELETE` | `/auth/spiffe/role/:name` |

### Parameters

- `name` `(string: <required>)` - The name of the role specified in the URL.

## List roles

Lists the names of all roles.

| Method | Path                |
|:-------|:--------------------|
| `LIST` | `/auth/spiffe/role` |

### Parameters

None

### Sample response

```json
{
  "keys": [
    "example-role"
  ]
}
```

## Login with SPIFFE ID

Authenticates a client using a SPIFFE JWT or x.509 SVID.

JWT SVIDs are read from the Authorization header as a Bearer token.

<Note title="Mount tuning required for JWT SVIDs">
To authenticate using JWT SVIDs, the SPIFFE backend mount must have the Authorization header listed
as a passthrough request header
</Note>

| Method | Path                 |
|:-------|:---------------------|
| `POST` | `/auth/spiffe/login` |

### Parameters

- `role` `(string: "")` - The name of the role to use for authentication. If not provided,
Vault will iterate over all configured roles.
- `type` `(string: "auto")` - Force which SVID source to use for authentication. The default `auto`
will prefer JWT SVIDs if provided, otherwise it will fallback to SVIDs from the peer x509 certificate.
Valid values are `jwt`, `cert` or `auto`.



